# 実行計画：SFプロトタイピング教育プラットフォーム

## プロジェクト概要

**プロジェクト名**：SFプロトタイピング教育プラットフォーム  
**目的**：自分探し×SFプロトタイピング×集団の意見の可視化を実現するWebプラットフォーム  
**開発期間**：約6ヶ月（Phase 1-5）  
**チーム構成**：フルスタックエンジニア、デザイナー、プロジェクトマネージャー

---

## 全体スケジュール

```
Phase 1: 基盤構築（4週間）
  ↓
Phase 2: コア機能（6週間）
  ↓
Phase 3: 可視化・分析（6週間）
  ↓
Phase 4: リアルタイム機能（4週間）
  ↓
Phase 5: 最適化・改善（4週間）
```

**合計**：約24週間（6ヶ月）

---

## Phase 1: 基盤構築（4週間）

### 目標
プロジェクトの基盤を構築し、開発環境と基本的なインフラを整備する。

### タスク分解

#### Week 1: プロジェクトセットアップ

**1.1 開発環境の構築**
- [ ] Next.js 14+ プロジェクトの初期化（App Router）
- [ ] TypeScript設定（strict mode）
- [ ] Tailwind CSS設定（カスタムテーマ）
- [ ] ESLint、Prettier設定
- [ ] Gitリポジトリ初期化、ブランチ戦略定義
- [ ] 開発環境のDocker化（オプション）

**1.2 デザイントークン定義**
- [ ] Figmaデザイントークンの作成
- [ ] Tailwind設定ファイルへのトークン反映
- [ ] TypeScript型定義（Design Tokens）
- [ ] トークンの命名規則統一（Figma ↔ 実装）

**1.3 基本的なUIコンポーネントライブラリ**
- [ ] ボタンコンポーネント（Primary, Secondary, 質問回答ボタン）
- [ ] 入力フィールドコンポーネント（Text Input, Slider）
- [ ] カードコンポーネント（Basic Card, Interactive Card）
- [ ] プログレスバーコンポーネント
- [ ] ローディングスピナーコンポーネント
- [ ] アコーディオンコンポーネント
- [ ] 各コンポーネントのStorybook作成

**デリバラブル**：
- Next.jsプロジェクトの初期セットアップ
- デザイントークン定義（Figma + Tailwind）
- 基本UIコンポーネントライブラリ（Storybook）

#### Week 2: データベース設計・実装

**2.1 データベーススキーマ設計**
- [ ] Prismaスキーマの設計
  - Session, Theme, Question, BigFiveResult
  - StudentResponse, OpinionMapping
  - Student, Teacher, School（Future Work対応）
- [ ] リレーション定義
- [ ] インデックス設計（パフォーマンス最適化）
- [ ] マイグレーションファイル作成

**2.2 データベース環境構築**
- [ ] PostgreSQLデータベースのセットアップ（開発環境）
- [ ] Prisma Migrateの実行
- [ ] シードデータの作成（開発用）
- [ ] データベース接続のテスト

**2.3 データアクセス層の実装**
- [ ] Prisma Clientの設定
- [ ] 基本的なCRUD操作の実装
- [ ] トランザクション処理の実装
- [ ] エラーハンドリングの実装

**デリバラブル**：
- Prismaスキーマ定義
- データベースマイグレーション
- 基本的なデータアクセス層

#### Week 3: 認証・認可基盤

**3.1 認証システムの実装**
- [ ] セッションID生成（UUID v4）
- [ ] パスコード管理（bcryptハッシュ化）
- [ ] JWTトークン発行・検証
  - アクセストークン（15分有効期限）
  - リフレッシュトークン（8時間有効期限、ローテーション方式）
- [ ] ワンタイム参加コード生成（学生用）
- [ ] ログイン失敗制御（5回失敗で15分ロックアウト）

**3.2 認可システムの実装**
- [ ] ロールベースアクセス制御（RBAC）
- [ ] 認可マトリクスの定義（Admin / Student / Session単位）
- [ ] ミドルウェア実装（認証・認可チェック）
- [ ] APIエンドポイントへの認可チェック適用

**3.3 セキュリティ対策**
- [ ] CSRF対策（Synchronizer Tokenまたは二重送信Cookie）
- [ ] XSS対策（入力サニタイズ、出力エスケープ）
- [ ] CSP設定（Content Security Policy）
- [ ] セキュリティヘッダ設定（HSTS、X-Content-Type-Options等）
- [ ] レート制限実装（ログイン、回答投稿、SSE接続）

**デリバラブル**：
- 認証・認可システム
- セキュリティ対策の実装
- APIエンドポイントの保護

#### Week 4: アクセシビリティ基盤

**4.1 アクセシビリティ基準の策定**
- [ ] WCAG 2.1 AA準拠のチェック項目策定
- [ ] アクセシビリティテスト計画の作成
- [ ] キーボードナビゲーション仕様の定義
- [ ] スクリーンリーダー対応仕様の定義

**4.2 アクセシビリティ実装**
- [ ] ARIA属性の実装（aria-label, aria-labelledby等）
- [ ] セマンティックHTMLの使用
- [ ] フォーカス管理の実装（フォーカスインジケーター、フォーカストラップ）
- [ ] キーボードショートカットの実装
- [ ] 色だけに依存しない情報伝達の実装

**4.3 アクセシビリティテスト**
- [ ] axe-coreによる自動テスト
- [ ] キーボード操作テスト
- [ ] スクリーンリーダーテスト（NVDA、JAWS）

**デリバラブル**：
- アクセシビリティ基準ドキュメント
- アクセシビリティ実装
- アクセシビリティテスト結果

### Phase 1 マイルストーン

- ✅ 開発環境の構築完了
- ✅ デザイントークン定義完了
- ✅ 基本UIコンポーネントライブラリ完成
- ✅ データベーススキーマ実装完了
- ✅ 認証・認可システム実装完了
- ✅ アクセシビリティ基準策定完了

---

## Phase 2: コア機能（6週間）

### 目標
生徒と管理者の主要機能を実装し、基本的なワークフローを完成させる。

### タスク分解

#### Week 5-6: セッション管理機能

**5.1 セッション管理API**
- [ ] `POST /api/session`：セッション作成
- [ ] `GET /api/session/current`：現在のセッション情報取得
- [ ] `PUT /api/session`：セッション更新
- [ ] `DELETE /api/session`：セッション削除
- [ ] セッション状態管理（preparing → active → completed → archived）

**5.2 セッション管理UI（管理者向け）**
- [ ] セッション作成画面
- [ ] セッション一覧画面
- [ ] セッション詳細画面
- [ ] セッションID共有機能（URL生成）

**5.3 セッション参加機能（生徒向け）**
- [ ] セッションID入力画面
- [ ] ワンタイム参加コード入力画面
- [ ] セッション情報表示

**デリバラブル**：
- セッション管理API
- セッション管理UI（管理者向け）
- セッション参加機能（生徒向け）

#### Week 7-8: インスタントビッグファイブ診断

**7.1 Big Five診断UI**
- [ ] 診断画面（10問、5段階スライダー）
- [ ] 進捗バー表示
- [ ] 質問の表示・遷移アニメーション
- [ ] ナビゲーション（次へ、戻る）

**7.2 スコア計算ロジック**
- [ ] 質問6-10の点数反転処理
- [ ] 各特性のスコア計算（外向性、協調性、誠実性、神経症傾向、開放性）
- [ ] スコアの分類（低め：0-4、高め：5-8）

**7.3 結果表示**
- [ ] レーダーチャート表示（モノクロ、濃淡で表現）
- [ ] 各特性の説明文表示
- [ ] 結果保存API（`POST /api/big-five-results`）

**7.4 データフロー実装**
- [ ] LocalStorageへの一時保存
- [ ] API呼び出し（10問完了後）
- [ ] データベースへの保存

**デリバラブル**：
- Big Five診断機能（UI + ロジック）
- 結果表示画面
- データ保存機能

#### Week 9-10: テーマ選択・メインページ

**9.1 テーマ選択機能**
- [ ] テーマ一覧取得API（`GET /api/themes`）
- [ ] テーマ選択画面（グリッド表示、カードデザイン）
- [ ] テーマ選択アニメーション
- [ ] 選択データの保存

**9.2 メインページ（テーマ概要）**
- [ ] メインページコンテンツ取得API
- [ ] メインページUI（スクロール可能、段階的表示）
- [ ] SF作品引用の表示
- [ ] 研究紹介の表示
- [ ] 参考ページへのリンク

**9.3 グループ活動機能**
- [ ] グループ活動画面（選択肢のカード表示）
- [ ] 複数選択機能
- [ ] テキスト入力（任意）
- [ ] データ保存API（`POST /api/group-activities`）

**デリバラブル**：
- テーマ選択機能
- メインページ表示機能
- グループ活動機能

#### Week 11-12: 質問回答機能

**11.1 質問回答UI**
- [ ] 質問表示画面（1問ずつ全画面表示）
- [ ] 逆三角形ボタン配置の実装
  - 「わからない」：中央上部（140px × 70px）
  - 「はい」：左下（100px × 50px）
  - 「いいえ」：右下（100px × 50px）
- [ ] アイコン実装（✓、✗、?）
- [ ] ボタンの状態管理（hover, focus, active, selected）
- [ ] 初回ガイド表示（最初の3問で表示、以後は任意で再表示可能）

**11.2 質問回答ロジック**
- [ ] 質問取得API（`GET /api/questions?themeId=xxx`）
- [ ] 回答保存API（`POST /api/responses`）
- [ ] 自動保存機能（バックグラウンド、非同期）
- [ ] 進捗管理（20問中何問完了か）

**11.3 オフライン対応**
- [ ] LocalStorageへの保存実装
- [ ] ネットワーク復旧時の自動同期
- [ ] 競合解決（Last-Write-Wins）
- [ ] 同期状態の表示（同期中、同期済み、オフライン）

**11.4 マイクロコピー実装**
- [ ] 不安軽減コピー（「わからない」を選んでも不利益がないこと）
- [ ] 匿名性説明
- [ ] 回答取り消し可否の明示

**11.5 完了画面**
- [ ] 回答完了メッセージ
- [ ] 回答サマリー表示
- [ ] 「結果を確認する」ボタン

**デリバラブル**：
- 質問回答機能（UI + ロジック）
- オフライン対応
- マイクロコピー実装

### Phase 2 マイルストーン

- ✅ セッション管理機能完成
- ✅ Big Five診断機能完成
- ✅ テーマ選択・メインページ完成
- ✅ 質問回答機能完成
- ✅ 基本的なワークフローが動作

---

## Phase 3: 可視化・分析（6週間）

### 目標
UMAPベースの意見マッピングと分析機能を実装する。

### タスク分解

#### Week 13-14: UMAP計算エンジン

**13.1 UMAP実装の選択**
- [ ] JavaScript実装（`umap-js`）の評価
- [ ] プロトタイプ実装（50人、25次元）
- [ ] パフォーマンステスト（ChromeBook基準）
- [ ] WASM実装の必要性判断

**13.2 データ前処理**
- [ ] 回答の数値化（yes=1, no=-1, unknown=0）
- [ ] Big Fiveスコアの統合（0-8スケール）
- [ ] 25次元ベクトルの生成
- [ ] 正規化処理（オプション）

**13.3 UMAP計算実装**
- [ ] UMAPパラメータ設定（n_neighbors=20, min_dist=0.2, metric='cosine'）
- [ ] Web Workerでの実行（メインスレッドをブロックしない）
- [ ] プログレスバー表示
- [ ] 計算結果のキャッシュ（IndexedDB）

**13.4 WASM実装（オプション）**
- [ ] Rust + wasm-packでの実装
- [ ] WASMモジュールのビルド
- [ ] Web Workerからの呼び出し
- [ ] パフォーマンス比較（JavaScript vs WASM）

**デリバラブル**：
- UMAP計算エンジン（JavaScriptまたはWASM）
- データ前処理ロジック
- 計算結果のキャッシュ機能

#### Week 15-16: クラスタリング・対立・合意検出

**15.1 クラスタリング実装**
- [ ] K-meansアルゴリズムの実装（JavaScriptまたはWASM）
- [ ] クラスタ数の自動決定（エルボー法、2-10クラスタ）
- [ ] クラスタIDの割り当て

**15.2 対立領域の検出**
- [ ] クラスタ間距離の計算
- [ ] 対立閾値の設定（平均距離の1.5倍以上）
- [ ] 対立領域の可視化データ生成
- [ ] 質的分析（どの質問で対立しているか）

**15.3 合意領域の検出**
- [ ] クラスタ内密度の計算（K近傍法）
- [ ] 合意閾値の設定
- [ ] 合意領域の可視化データ生成
- [ ] 質的分析（どの質問で合意しているか）

**デリバラブル**：
- クラスタリング機能
- 対立・合意領域の検出機能
- 分析データの生成

#### Week 17-18: 可視化UI実装

**17.1 可視化レンダリング**
- [ ] D3.jsまたはObservable Plotの選択
- [ ] 2D散布図の実装（UMAP座標）
- [ ] CanvasまたはSVGの選択（パフォーマンス考慮）
- [ ] インタラクティブ操作（ズーム、パン、ホバー）

**17.2 生徒向け可視化画面**
- [ ] 可視化エリア（80%）+ コントロールパネル（20%）
- [ ] 自分の位置のハイライト表示
- [ ] クラスタ表示（モノクロスケール内で濃淡）
- [ ] 対立・合意領域の表示（半透明オーバーレイ）
- [ ] コントロールパネル（表示オプション、自分の情報、近傍学生）

**17.3 読解支援UI**
- [ ] 凡例の表示
- [ ] クラスタ説明の表示
- [ ] ツールチップ（ホバー時の詳細情報）
- [ ] 可視化の読み方チュートリアル
- [ ] 自己位置の明示（注釈表示）
- [ ] 解釈上の注意表示（「本結果は統計的傾向であり、個人評価を目的としない」）

**17.4 管理者向け可視化画面**
- [ ] 可視化エリア（60%）+ 統計パネル（40%）
- [ ] 学生名の表示（匿名化オプション）
- [ ] クラスタ統計情報の表示
- [ ] 対立・合意領域の詳細分析表示

**デリバラブル**：
- 可視化UI（生徒向け・管理者向け）
- 読解支援UI
- インタラクティブ操作機能

#### Week 19-20: 情報の階層整理機能

**19.1 階層構造の実装**
- [ ] アコーディオンUIの実装
- [ ] 6段階の階層構造実装
  - レベル1：全体サマリー（常に表示）
  - レベル2：クラスタ分析結果（展開可能）
  - レベル3：質問ごとの解答分布（展開可能）
  - レベル4：対立領域の詳細分析（展開可能）
  - レベル5：合意領域の詳細分析（展開可能）
  - レベル6：性格特性の分布（展開可能）

**19.2 質問ごとの解答分布機能**
- [ ] 質問一覧表示（20問）
- [ ] 各質問の展開機能
- [ ] 全体の回答分布（円グラフ）
- [ ] クラスタ別の回答分布（比較表または棒グラフ）
- [ ] フィルター機能（対立が大きい質問のみ、合意が強い質問のみ、わからないが多い質問のみ）

**19.3 統計分析機能**
- [ ] 対立スコアの計算（0-100）
- [ ] 合意スコアの計算（0-100）
- [ ] 性格特性と回答パターンの相関分析
- [ ] 統計データの可視化（ヒストグラム、レーダーチャート）

**デリバラブル**：
- 情報の階層整理機能
- 質問ごとの解答分布機能
- 統計分析機能

### Phase 3 マイルストーン

- ✅ UMAP計算エンジン完成
- ✅ クラスタリング・対立・合意検出完成
- ✅ 可視化UI完成（生徒向け・管理者向け）
- ✅ 情報の階層整理機能完成

---

## Phase 4: リアルタイム機能（4週間）

### 目標
管理者ダッシュボードとリアルタイム監視機能を実装する。

### タスク分解

#### Week 21-22: 管理者ダッシュボード

**21.1 ダッシュボードUI**
- [ ] 3カラムグリッドレイアウト
- [ ] セッション情報表示（上部）
- [ ] 学生一覧テーブル（左カラム、40%）
- [ ] 進捗統計（中央カラム、35%）
  - 円グラフ：回答完了率の分布
  - 棒グラフ：Big Fiveスコアの平均値
  - 時系列グラフ：回答数の推移
- [ ] アクションパネル（右カラム、25%）

**21.2 学生管理機能**
- [ ] 学生一覧テーブル（ソート、フィルター、検索）
- [ ] 学生詳細画面（タブ形式：基本情報、回答一覧、可視化上の位置）
- [ ] 一括操作（一括エクスポート、一括通知）

**21.3 進捗統計機能**
- [ ] 統計データの取得API
- [ ] グラフの実装（D3.jsまたはChart.js）
- [ ] リアルタイム更新の視覚的フィードバック

**デリバラブル**：
- 管理者ダッシュボードUI
- 学生管理機能
- 進捗統計機能

#### Week 23-24: SSE実装

**23.1 SSEサーバー側実装**
- [ ] SSEエンドポイント実装（`GET /api/events/session/progress`）
- [ ] セッション単位の進捗データ送信（5秒ごと）
- [ ] 接続管理（接続数上限、アイドルタイムアウト）
- [ ] 認可チェック（セッション境界での厳密認可）

**23.2 SSEクライアント側実装**
- [ ] EventSource APIの実装
- [ ] 再接続ロジック（指数バックオフ）
- [ ] `Last-Event-ID`対応（欠落イベントの再送）
- [ ] 切断時のUI表示（再接続中バナー）
- [ ] 最大再試行回数超過時の手動再接続UI

**23.3 リアルタイム更新の視覚的フィードバック**
- [ ] 更新された項目のハイライト（1秒間）
- [ ] 数値の変化アニメーション（カウントアップ）
- [ ] グラフの更新（スムーズなトランジション、300ms）

**23.4 セッション進行管理（Mentimeter風）**
- [ ] ステップ管理機能（6ステップ）
- [ ] 「次のステップへ」ボタン
- [ ] ステップのロック/アンロック機能
- [ ] 各ステップの完了率表示

**デリバラブル**：
- SSE実装（サーバー側・クライアント側）
- リアルタイム更新機能
- セッション進行管理機能

### Phase 4 マイルストーン

- ✅ 管理者ダッシュボード完成
- ✅ SSE実装完成
- ✅ リアルタイム監視機能完成
- ✅ セッション進行管理機能完成

---

## Phase 5: 最適化・改善（4週間）

### 目標
パフォーマンス最適化、UI/UX改善、エラーハンドリング強化を行う。

### タスク分解

#### Week 25-26: パフォーマンス最適化

**25.1 フロントエンド最適化**
- [ ] コード分割（Next.js動的インポート）
- [ ] WASMモジュールの遅延ロード
- [ ] 画像最適化（Next.js Imageコンポーネント、WebP形式）
- [ ] バンドルサイズ最適化（Tree shaking、未使用コード削除）
- [ ] 仮想スクロール実装（学生一覧が100人以上の場合）

**25.2 バックエンド最適化**
- [ ] データベースクエリ最適化（インデックス追加、EXPLAIN分析）
- [ ] ページネーション実装（学生一覧は20件ずつ）
- [ ] 集計クエリの最適化（DB側で集計）
- [ ] キャッシング戦略（Redis、SWR/React Query）

**25.3 パフォーマンステスト**
- [ ] 50人、100人、150人での処理時間計測
- [ ] P50、P95、P99の計測
- [ ] ChromeBook基準でのテスト
- [ ] 目標値との比較（初回ロード<2秒、UMAP計算<5秒等）

**デリバラブル**：
- パフォーマンス最適化実装
- パフォーマンステスト結果
- 最適化レポート

#### Week 27-28: UI/UX改善・エラーハンドリング

**27.1 UI/UX改善**
- [ ] 逆三角形UIのA/Bテスト（必要に応じて）
- [ ] マイクロコピーの改善
- [ ] アニメーションの調整（読解優先の上限：250ms以内）
- [ ] レスポンシブデザインの調整
- [ ] タッチ操作の改善

**27.2 エラーハンドリング強化**
- [ ] グローバルエラーハンドラー（React Error Boundary）
- [ ] APIエラー時のリトライロジック（指数バックオフ）
- [ ] ユーザーフレンドリーなエラーメッセージ
- [ ] エラーログの構造化（Sentry連携）

**27.3 ログ・モニタリング**
- [ ] サーバー側ログ設定（Winston、構造化ログ）
- [ ] クライアント側エラーログ（Sentry）
- [ ] パフォーマンスモニタリング（Vercel Analytics）
- [ ] ユーザー行動分析（Google Analytics、匿名化）

**27.4 セキュリティレビュー**
- [ ] 脅威モデリング更新（STRIDEベース）
- [ ] OWASP ASVS Level 2相当のチェック
- [ ] SAST/SCA/DASTテスト
- [ ] セキュリティテスト結果の文書化

**デリバラブル**：
- UI/UX改善実装
- エラーハンドリング強化
- ログ・モニタリング設定
- セキュリティレビュー結果

### Phase 5 マイルストーン

- ✅ パフォーマンス最適化完了
- ✅ UI/UX改善完了
- ✅ エラーハンドリング強化完了
- ✅ セキュリティレビュー完了

---

## テスト戦略

### 単体テスト

**対象**：
- ビジネスロジック（Big Fiveスコア計算、UMAP前処理）
- ユーティリティ関数（データ変換、バリデーション）
- Reactコンポーネント（UIコンポーネント）

**ツール**：Jest、React Testing Library  
**カバレッジ目標**：80%以上  
**実行タイミング**：各Phaseの実装中、PR作成時

### 統合テスト

**対象**：
- APIエンドポイント（Next.js API Routes）
- データベース操作（Prisma）
- SSE接続

**ツール**：Jest + Supertest  
**実行タイミング**：Phase 2-4の各完了時、マージ時

### E2Eテスト

**対象**：
- 主要なユーザーフロー：
  - 管理者：セッション作成 → 学生監視 → 結果分析
  - 学生：Big Five診断 → 質問回答 → 可視化確認

**ツール**：Playwright または Cypress  
**実行タイミング**：Phase 4完了時、本番リリース前

### UX/アクセシビリティ検証

**アクセシビリティ監査**：
- axe-coreによる自動テスト
- 手動監査（キーボード操作、スクリーンリーダー読み上げ）

**可視化理解度テスト**：
- 生徒ユーザーテストで読解正答率を計測（目標：80%以上）

**操作迷い計測**：
- 回答画面の再クリック率、戻る率、離脱率をイベント分析で計測（目標：10%未満）

**実行タイミング**：Phase 3-4完了時

### セキュリティテスト

**SAST**：静的解析（CodeQL、ESLint security plugin）をPRで必須化  
**SCA**：依存関係脆弱性スキャン（Dependabot/Renovate）を継続運用  
**DAST**：ステージング環境で主要APIと認証フローを定期診断  
**回帰項目**：認可回避、IDOR、CSRF、XSS、レート制限回避を自動テスト化

**実行タイミング**：Phase 1完了時、Phase 5完了時、定期的

---

## デプロイメント計画

### 環境構成

**開発環境**：
- ローカル開発（Docker Compose）
- 開発用データベース（PostgreSQL）

**ステージング環境**：
- Vercel（ステージング用プロジェクト）
- ステージング用データベース（PostgreSQL）
- 本番環境と同等の設定

**本番環境**：
- Vercel（本番用プロジェクト）
- 本番用データベース（PostgreSQL、マネージドサービス推奨）
- CDN配信

### CI/CDパイプライン

**GitHub Actions設定**：

**プルリクエスト時**：
- リントチェック（ESLint）
- 型チェック（TypeScript）
- 単体テスト実行
- ビルドテスト
- SAST/SCA（セキュリティスキャン）

**マージ時**：
- 統合テスト実行
- DAST（ステージング環境）
- ステージング環境へデプロイ

**本番リリース時**：
- E2Eテスト実行
- 重大脆弱性ゲート通過確認
- 本番環境へデプロイ
- デプロイ後のヘルスチェック

### データバックアップ

**自動バックアップ**：
- 頻度：1日1回（深夜）
- 保存期間：30日間
- 保存先：クラウドストレージ（AWS S3、Google Cloud Storage）
- 暗号化：バックアップファイルは暗号化保存

**手動バックアップ**：
- 重要なセッション終了後

**災害復旧計画**：
- RTO（目標復旧時間）：4時間以内
- RPO（目標復旧時点）：24時間以内
- 復旧手順：ドキュメント化、定期的な復旧訓練

---

## リスク管理

### 技術的リスク

**リスク1：UMAP計算のパフォーマンス**
- **影響**：高（ChromeBookでの計算時間が目標値を超える可能性）
- **対策**：
  - Phase 3でJavaScript実装をプロトタイプし、パフォーマンスを確認
  - 必要に応じてWASM実装に切り替え
  - サンプリング機能の実装（100人以上の場合）

**リスク2：WASM実装の複雑さ**
- **影響**：中（学習コストが高い、開発期間が延びる可能性）
- **対策**：
  - 初期実装はJavaScriptでプロトタイプ
  - パフォーマンスが問題になったらWASM化
  - 外部ライブラリの活用を検討

**リスク3：SSE接続の信頼性**
- **影響**：中（ネットワークエラー時の再接続が失敗する可能性）
- **対策**：
  - 自動再接続ロジックの実装
  - `Last-Event-ID`による欠落イベントの再送
  - ポーリングフォールバック（SSE失敗時）

### プロジェクトリスク

**リスク4：要件の変更**
- **影響**：中（実装中に要件が変更される可能性）
- **対策**：
  - 要件定義書の明確化
  - 変更管理プロセスの定義
  - 定期的なステークホルダーレビュー

**リスク5：スケジュール遅延**
- **影響**：中（各Phaseの遅延が累積する可能性）
- **対策**：
  - 各Phaseでマイルストーンを設定
  - 週次進捗レビュー
  - 優先度の明確化（MVP機能の特定）

### セキュリティリスク

**リスク6：セキュリティ脆弱性**
- **影響**：高（データ漏えい、不正アクセスのリスク）
- **対策**：
  - セキュリティレビューの実施（Phase 1、Phase 5）
  - SAST/SCA/DASTテストの継続実施
  - 脅威モデリングの定期更新

---

## 受け入れ基準（リリースゲート）

### 機能要件

- [ ] 主要なユーザーフローが動作（管理者：セッション作成 → 監視 → 分析、学生：診断 → 回答 → 可視化）
- [ ] 主要APIの正常系/異常系/認証失敗のレスポンス仕様が文書化されている
- [ ] 可視化画面に「解釈上の注意」注記が表示されている

### 非機能要件

- [ ] 50/100/150人条件で性能計測を実施し、P95が目標値以内である
  - 初回ロード時間：< 2秒
  - 回答保存時間：< 500ms
  - UMAP計算時間：< 5秒（50人）
  - リアルタイム更新遅延：< 1秒
- [ ] UX受け入れ基準を満たしている
  - 生徒の20問回答完了時間（中央値）：15分以内
  - 初回利用者の回答フロー完了率：90%以上
  - 逆三角形UIに関する操作迷い指標：10%未満
  - 可視化の読解テスト正答率：80%以上

### セキュリティ要件

- [ ] OWASP ASVS Level 2相当のセキュリティ基準を満たしている
- [ ] セキュリティテスト（SAST/SCA/DAST）を実施し、重大脆弱性がない
- [ ] 監査ログ機能が実装されている

### 運用要件

- [ ] 障害時Runbook（問い合わせ窓口、ログ採取、一次切り分け）が整備されている
- [ ] データバックアップ・災害復旧計画が整備されている
- [ ] モニタリング・アラート設定が完了している

---

## マイルストーン一覧

| Phase | マイルストーン | 目標日 | デリバラブル |
|-------|--------------|--------|------------|
| Phase 1 | 基盤構築完了 | Week 4 | 開発環境、DB、認証、アクセシビリティ基盤 |
| Phase 2 | コア機能完成 | Week 12 | セッション管理、Big Five、質問回答 |
| Phase 3 | 可視化・分析完成 | Week 20 | UMAP、クラスタリング、可視化UI |
| Phase 4 | リアルタイム機能完成 | Week 24 | ダッシュボード、SSE |
| Phase 5 | 最適化・改善完了 | Week 28 | パフォーマンス最適化、セキュリティレビュー |

---

## 次のステップ

1. **実行計画の承認**：ステークホルダーによる承認
2. **チーム編成**：フルスタックエンジニア、デザイナー、PMのアサイン
3. **開発環境の準備**：GitHubリポジトリ、Vercelプロジェクト、データベース環境
4. **Phase 1開始**：プロジェクトセットアップから開始

---

## 関連ドキュメント

- **要件定義書**：`docs/requirement.md`
- **エンジニアレビュー**：`docs/requirement_review.md`
- **デザイナーレビュー**：`docs/designer-evaluation.md`
